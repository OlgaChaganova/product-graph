[34m[1mwandb[39m[22m: logging graph, to disable use `wandb.watch(log_graph=False)`
Trainer already configured with model summary callbacks: [<class 'pytorch_lightning.callbacks.rich_model_summary.RichModelSummary'>]. Skipping setting a default `ModelSummary` callback.
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
INFO:root:Mode: train, number of files: 196615
INFO:root:Mode: val, number of files: 39323
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
┏━━━┳━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━┓
┃[1m   [22m┃[1m Name            [22m┃[1m Type                 [22m┃[1m Params [22m┃
┡━━━╇━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━┩
│ 0 │ model           │ MultiLayerPerceptron │  169 K │
│ 1 │ criterion       │ CrossEntropyLoss     │      0 │
│ 2 │ accuracy        │ MulticlassAccuracy   │      0 │
│ 3 │ f1_score        │ MulticlassF1Score    │      0 │
│ 4 │ precision_score │ MulticlassPrecision  │      0 │
│ 5 │ recall_score    │ MulticlassRecall     │      0 │
└───┴─────────────────┴──────────────────────┴────────┘
[1mTrainable params[22m: 169 K
[1mNon-trainable params[22m: 0
[1mTotal params[22m: 169 K
[1mTotal estimated model params size (MB)[22m: 0













Epoch 13:  98%|██████████████████████████████▌| 454/461 [00:02<00:00, 169.13it/s, loss=0.729, v_num=trrk]


















Epoch 39:  84%|██████████████████████████     | 387/461 [00:02<00:00, 160.39it/s, loss=0.607, v_num=trrk]



Epoch 42:  95%|█████████████████████████████▎ | 436/461 [00:02<00:00, 168.50it/s, loss=0.618, v_num=trrk]

Epoch 44:  83%|█████████████████████████▊     | 384/461 [00:02<00:00, 161.65it/s, loss=0.605, v_num=trrk]


Epoch 46:  98%|██████████████████████████████▌| 454/461 [00:02<00:00, 160.29it/s, loss=0.602, v_num=trrk]



Epoch 49:  83%|██████████████████████████▋     | 384/461 [00:02<00:00, 168.04it/s, loss=0.62, v_num=trrk]










Epoch 57:  83%|█████████████████████████▊     | 384/461 [00:02<00:00, 164.61it/s, loss=0.586, v_num=trrk]


Epoch 59:  95%|█████████████████████████████▌ | 439/461 [00:02<00:00, 167.73it/s, loss=0.577, v_num=trrk]



Epoch 62:  83%|█████████████████████████▊     | 384/461 [00:02<00:00, 171.41it/s, loss=0.569, v_num=trrk]






Epoch 67:  93%|████████████████████████████▊  | 429/461 [00:02<00:00, 170.95it/s, loss=0.582, v_num=trrk]



Epoch 70:  87%|██████████████████████████▊    | 399/461 [00:02<00:00, 163.52it/s, loss=0.571, v_num=trrk]



Epoch 73:  97%|█████████████████████████████▉ | 446/461 [00:02<00:00, 164.68it/s, loss=0.575, v_num=trrk]



Epoch 76:  99%|██████████████████████████████▊| 458/461 [00:02<00:00, 170.67it/s, loss=0.568, v_num=trrk]



Epoch 79:  95%|█████████████████████████████▍ | 437/461 [00:02<00:00, 169.89it/s, loss=0.552, v_num=trrk]



Epoch 82:  95%|█████████████████████████████▍ | 437/461 [00:02<00:00, 167.10it/s, loss=0.552, v_num=trrk]



Epoch 85:  83%|█████████████████████████▊     | 384/461 [00:02<00:00, 171.69it/s, loss=0.533, v_num=trrk]



Epoch 88:  83%|█████████████████████████▊     | 384/461 [00:02<00:00, 172.24it/s, loss=0.553, v_num=trrk]















Epoch 100:  94%|████████████████████████████▏ | 433/461 [00:02<00:00, 168.49it/s, loss=0.538, v_num=trrk]



Epoch 103:  91%|███████████████████████████▎  | 420/461 [00:02<00:00, 166.32it/s, loss=0.519, v_num=trrk]



Epoch 106:  85%|█████████████████████████▌    | 392/461 [00:02<00:00, 162.59it/s, loss=0.539, v_num=trrk]



Epoch 109:  83%|████████████████████████▉     | 384/461 [00:02<00:00, 172.37it/s, loss=0.547, v_num=trrk]



Epoch 112:  83%|████████████████████████▉     | 384/461 [00:02<00:00, 171.97it/s, loss=0.512, v_num=trrk]



Epoch 115:  83%|████████████████████████▉     | 384/461 [00:02<00:00, 173.99it/s, loss=0.546, v_num=trrk]



Epoch 118:  83%|████████████████████████▉     | 384/461 [00:02<00:00, 171.34it/s, loss=0.537, v_num=trrk]



Epoch 121:  83%|████████████████████████▉     | 384/461 [00:02<00:00, 173.42it/s, loss=0.528, v_num=trrk]














Epoch 132:  98%|█████████████████████████████▎| 451/461 [00:02<00:00, 171.00it/s, loss=0.507, v_num=trrk]



Epoch 135:  97%|█████████████████████████████▏| 449/461 [00:02<00:00, 171.72it/s, loss=0.496, v_num=trrk]
Validation DataLoader 0:  86%|████████████████████████████████████      | 66/77 [00:00<00:00, 250.96it/s]
/home/olik/anaconda3/envs/graph-venv/lib/python3.10/site-packages/pytorch_lightning/trainer/call.py:48: UserWarning: Detected KeyboardInterrupt, attempting graceful shutdown...

  rank_zero_warn("Detected KeyboardInterrupt, attempting graceful shutdown...")
INFO:root:Mode: test, number of files: 2213091
Restoring states from the checkpoint path at /home/olik/edu/product-graph/checkpoints/mlp_baseline_2c8476/epoch=37-step=14592.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]







Testing DataLoader 0: 100%|█████████████████████████████████████████| 4323/4323 [00:14<00:00, 299.48it/s]
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃[1m        Test metric        [22m┃[1m       DataLoader 0        [22m┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│[36m         test_acc          [39m│[35m    0.6442316174507141     [39m│
│[36m          test_f1          [39m│[35m    0.6311131715774536     [39m│
│[36m         test_loss         [39m│[35m    1.6116647720336914     [39m│
│[36m      test_precision       [39m│[35m    0.6441815495491028     [39m│
│[36m     test_recall_score     [39m│[35m    0.6441815495491028     [39m│
└───────────────────────────┴───────────────────────────┘